extend type Order {
  payments: [Payment!]!
  cancellation: OrderCancellation
}

type Query {
  orders(input: OrderListInput): OrderList!
}

type Mutation {
  markOrderAsProcessing(id: ID!): OrderResult!

  addFulfillmentToOrder(id: ID!, input: AddFulfillmentToOrderInput!): OrderResult!

  markFulfillmentAsShipped(fulfillmentId: ID!, input: MarkFulfillmentAsShippedInput!): OrderResult!
  markFulfillmentAsReadyForPickup(fulfillmentId: ID!): OrderResult!
  markFulfillmentAsDelivered(fulfillmentId: ID!): OrderResult!
  markFulfillmentAsPickedUp(fulfillmentId: ID!): OrderResult!

  cancelFulfillmentInOrder(fulfillmentId: ID!): OrderResult!

  markOrderAsCompleted(id: ID!): OrderResult!
  cancelOrder(id: ID!, input: CancelOrderInput!): OrderResult!
}

input AddFulfillmentToOrderInput {
  orderLines: [AddFulfillmentToOrderInputOrderLine!]!
  trackingCode: String
  carrier: String
}

input MarkFulfillmentAsShippedInput {
  trackingCode: String!
  carrier: String!
}

input AddFulfillmentToOrderInputOrderLine {
  id: ID!
  quantity: Int!
}

input CancelOrderInput {
  reason: String!
  shouldRestock: Boolean
}

type OrderResult {
  order: Order
  apiErrors: [OrderErrorResult!]!
}

type OrderErrorResult {
  code: OrderErrorCode!
  message: String!
}

enum OrderErrorCode {
  FORBIDDEN_ORDER_ACTION
  MISSING_SHIPPING_DETAILS
  EXCEEDS_FULFILLMENT_LINE_QUANTITY_ERROR
  INVALID_FULFILLMENT_LINE_QUANTITY
  FORBIDDEN_FULFILLMENT_ACTION
  INVALID_FULFILLMENT_STATE_TRANSITION
}

extend input OrderFilters {
  """
  Filter by order state
  """
  states: [OrderState!]
  """
  Filter by customer first name, last name, or email. When combined with code, uses OR logic.
  """
  customer: StringFilter
}
